# Deploying to Streamlit Cloud

This guide will help you deploy Broadgate to Streamlit Cloud.

## Prerequisites

1. A Streamlit Cloud account ([sign up here](https://streamlit.io/cloud))
2. Your Tavus API key
3. A persona ID (generated by running `setup.py` locally)

## Step-by-Step Deployment

### 1. Push Your Code to GitHub

```bash
git add .
git commit -m "Prepare for Streamlit Cloud deployment"
git push origin main
```
1. Go to your app's dashboard
2. Click **Settings** (âš™ï¸ icon)
3. Navigate to **Secrets** section
4. Add the following in TOML format:

```toml
API_KEY = "your_tavus_api_key_here"
BROADGATE_PERSONA_ID = "p92fb560a56c"
WEBHOOK_URL = "https://your-webhook-endpoint.com/webhook"
REPLICA_ID = "rfe12d8b9597"
```

**How to get your Persona ID:**

Run setup locally first:
```bash
python setup.py
```

This will output your `BROADGATE_PERSONA_ID`. Copy it to Streamlit Cloud secrets.

### 4. Save and Reboot

1. Click **"Save"** in the Secrets section
2. Your app will automatically reboot with the new configuration

## Troubleshooting

### Error: "Persona ID not configured"

**Cause:** Secrets not configured or incorrect key names

**Solution:**
- Verify secrets are added in Streamlit Cloud
- Ensure key names match exactly: `API_KEY`, `BROADGATE_PERSONA_ID`, etc.
- Click "Save" and wait for app to reboot

### Error: "API_KEY missing"

**Cause:** API key not set in secrets

**Solution:**
- Add `API_KEY = "your_key"` to Streamlit Cloud secrets
- Get your API key from [tavus.io](https://tavus.io)

### Database Issues

**Note:** Streamlit Cloud uses ephemeral storage. The SQLite database will reset on each deployment.

**For production:**
- Consider using a cloud database (PostgreSQL, MySQL)
- Or use Streamlit Cloud's persistent storage options

## Environment Variables vs Secrets

| Environment | Configuration Method |
|-------------|---------------------|
| **Local Development** | `.env` file |
| **Streamlit Cloud** | Secrets (TOML format) |

The app automatically detects which environment it's running in and uses the appropriate configuration method.

## Security Best Practices

âœ… **DO:**
- Keep `.env` in `.gitignore`
- Use Streamlit Cloud secrets for sensitive data
- Rotate API keys regularly

âŒ **DON'T:**
- Commit `.env` files to git
- Hardcode API keys in code
- Share secrets publicly

## Support

If you encounter issues:
1. Check Streamlit Cloud logs (Settings > Logs)
2. Verify all secrets are configured
3. Ensure your Tavus API key is valid
4. Contact support@broadgate.ai

---

**Happy Deploying! ğŸš€**
